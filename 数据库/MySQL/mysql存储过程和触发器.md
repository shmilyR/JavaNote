# MySQL存储过程和函数
存储过程和函数是事先经过编译并存储在数据库中的一段SQL语句的集合。  
存储过程和函数的区别在于函数必须有返回值，而存储过程没有，存储过程的参数可以使用IN、OUT、INOUT类型，而函数的参数只能是IN类型的。如果有函数从其他类型的数据库迁移到MySQL,那么就可能需要将函数改造成存储过程。  
在对存储过程或函数进行操作时，首先需要确定用户是否具有相应的权限。
# 存储过程
1. 定义:用户自定义的，一组为了完成特定功能的SQL语句集，涉及特定表的其他对象的操作，存储在数据库中，经过一次编译之后再不需要进行编译。 (效率高),通过存储过程的名称来调用存储过程。
2. 存储过程和函数的区别：
    1. 相同点：
        1. 存储过程和函数的目的都是为了可重复执行操作数据库的SQL语句的集合(提高效率)。
        2. 存储过程和函数都是一次编译，后续执行。
    2. 不同点：
        1. 存储过程一般由用户定义，而函数一般是数据库给定的；
        2. 标识符不同，存储过程：procedure 函数:function
        3. 存储过程没有返回值，函数有返回值
        4. 存储过程的参数是IN、OUT、INOUT。函数的参数是IN
# 存储过程的基本操作
1. 创建语法
```sql
create procedure 过程名字([参数列表])
begin
    过程体
end 
结束符
```
<font color="red">过程体中只有一条指令时，可以省略begin 和 end</font>
2. 查看存储过程
```sql
show procedure status\G;
```
3. 查看过程的创建语句
```sql
show create procedure status;
```
4. 调用过程:过程没有返回值，select就不可能调用
```sql
call 过程名(实例列表);//就会对应的执行过程体
```  
5. 删除过程
```sql
drop 过程名(实参列表)
```
# 存储过程的形参类型
1. IN:表示参数从外部传入里面(过程内部使用)，可以是直接数据，也可以是数据的变量
2. OUT：表示参数从过程里面保存到变量里面，提供给外部使用，传入的必须是变量。
<font color="red">若外部传入的变量有值，那么在传入过程之后，第一件事就是将变量清空设置为NULL.</font>
3. INOUT:数据可以从外部传入到内部使用，用时在内部操作之后，将内部数据传入到外部数据使用。
变量的基本使用：过程类型 变量名 变量类型
<font color="yellow">调用存储过程与直接执行SQL的效果是相同的，但是存储过程的好处在于处理逻辑都封装在数据库端，调用者不需要了解中间的处理逻辑，一旦处理逻辑发生变化，只需要修改存储过程即可，而对调用者的程序完全没有影响。</font>
# 触发器
1. 定义:触发器是一种特殊类型的存储过程。触发器主要是通过事件触发执行的。  
   tigger:触发器，提前给某张表的所有记录绑定一段代码，如果该行的条件满足操作(条件、触发)，提前准备好的代码就会执行。
2. 触发器的优点：触发器可以通过数据库的相关表实现级联更改(一个表的数据发生更改，触发器可以实现其他表的无痕操作)保证数据安全，进行安全校验。
3. 触发器的缺点：对于触发器的过度依赖，势必会影响数据库的结果，增加了维护的复杂度。
4. 触发器的使用：触发器执行的语句有以下原则：
    1. 触发程序不能调用将数据返回客户端的存储程序。也不能采用使用call语句的动态SQL，但是允许存储程序通过参数将数据返回触发程序，也就是存储过程或者函数通过OUT或者INOUT类型的参数将数据返回触发器是可以的，但是不能调用直接返回数据的过程。
    2. 不能在触发器中使用显式或隐式方式开始或结束事务的语句，如START TRANSACTION,COMMIT 或ROLLBACK。