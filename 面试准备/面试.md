# 数据库
## 聚簇索引和非聚簇索引的区别：
 + 聚集索引：
    + 聚集索引就是按照每张表的主键构造一棵B+树，同时叶子节点中存放的即为整张表的行记录数据，也将聚集索引的叶子节点称为数据页。聚集索引的这个特性决定了索引组织表中数据也是索引的一部分。每个数据页都通过一个双向链表来进行链接。
    + 由于实际的数据页只能按照一棵B+树进行排序，因此每张表只能拥有一个聚集索引，在多数情况下，查询优化器倾向于采用聚集索引。因为聚集索引能够在B+树索引的叶子节点上直接找到数据。此外，由于定义了数据的逻辑顺序，聚集索引能够特别快地访问针对范围值的查询。查询优化器能够快速发现某一段范围的数据页需要扫描。
    + 数据页上存放的是完整的每行的记录，而在非数据页的索引页中，存放的仅仅是键值及指向数据页的偏移量，而不是一个完整的行记录。
    + 聚集索引的存储并不是物理上连续的，而是逻辑上连续的。这其中有两点：
        + 页通过双向链表连接，页按照主键的顺序排序；
        + 每个页中的记录也是通过双向链表进行维护的，物理存储上可以同样不按照主键存储。
    + 聚集索引的好处：
        + 对于主键的排序查找和范围查找速度非常快，叶子节点的数据就是用户所要查询的数据。
+ 辅助索引(非聚集索引)
    + 叶子节点并不包含行记录的全部数据。叶子节点除了包含键值以外，每个叶子节点中的索引行中还包含了一个书签。该书签是用来告诉InnoDB存储引擎哪里可以找到与索引相对应的行数据。由于InnoDB存储引擎表示索引组织表，因此InnoDB存储引擎的辅助索引书签就是相应行数据的聚集索引键。
    + 辅助索引的存在并不影响数据在聚集索引中的组织。因此，每张表上可以有多个辅助索引。
    + 当通过辅助索引来寻找数据时，InnoDB存储引擎会遍历辅助索引并通过叶级别指针获得指向主键索引的主键，然后再通过主键索引来找到一个完整的记录。
    + 数据存储在一个地方，索引存储在另一个地方，索引带有指针指向数据的存储位置。索引中的项目按索引键值的顺序存储，而表中的信息按照另一种顺序存储。如果在表中未创建聚簇索引，则无法保证这些行具有特定的顺序。
+ 有索引就一定检索的快吗？  
    否。有些时候使用索引还不如不用索引快。举例：我们要检索的表中有8000条记录，如果不用索引，需要访问8000条*1000B/8KB=1000个页面；如果使用索引，首先检索索引，访问8000条*10B/8KB=10个页面，得到索引检索结果，再根据索引检索结果去对应数据页面，由于是检索所有的数据，所以，需要再访问8000条*1000B/8KB=1000个页面，将全部数据读取出来，一共访问了1010个页面。