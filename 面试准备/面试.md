# 数据库
## 聚簇索引和非聚簇索引的区别：
 + 聚集索引：
    + 聚集索引就是按照每张表的主键构造一棵B+树，同时叶子节点中存放的即为整张表的行记录数据，也将聚集索引的叶子节点称为数据页。聚集索引的这个特性决定了索引组织表中数据也是索引的一部分。每个数据页都通过一个双向链表来进行链接。
    + 由于实际的数据页只能按照一棵B+树进行排序，因此每张表只能拥有一个聚集索引，在多数情况下，查询优化器倾向于采用聚集索引。因为聚集索引能够在B+树索引的叶子节点上直接找到数据。此外，由于定义了数据的逻辑顺序，聚集索引能够特别快地访问针对范围值的查询。查询优化器能够快速发现某一段范围的数据页需要扫描。
    + 数据页上存放的是完整的每行的记录，而在非数据页的索引页中，存放的仅仅是键值及指向数据页的偏移量，而不是一个完整的行记录。
    + 聚集索引的存储并不是物理上连续的，而是逻辑上连续的。这其中有两点：
        + 页通过双向链表连接，页按照主键的顺序排序；
        + 每个页中的记录也是通过双向链表进行维护的，物理存储上可以同样不按照主键存储。
    + 聚集索引的好处：
        + 对于主键的排序查找和范围查找速度非常快，叶子节点的数据就是用户所要查询的数据。
+ 辅助索引(非聚集索引)
    + 叶子节点并不包含行记录的全部数据。叶子节点除了包含键值以外，每个叶子节点中的索引行中还包含了一个书签。该书签是用来告诉InnoDB存储引擎哪里可以找到与索引相对应的行数据。由于InnoDB存储引擎表示索引组织表，因此InnoDB存储引擎的辅助索引书签就是相应行数据的聚集索引键。
    + 辅助索引的存在并不影响数据在聚集索引中的组织。因此，每张表上可以有多个辅助索引。
    + 当通过辅助索引来寻找数据时，InnoDB存储引擎会遍历辅助索引并通过叶级别指针获得指向主键索引的主键，然后再通过主键索引来找到一个完整的记录。
    + 数据存储在一个地方，索引存储在另一个地方，索引带有指针指向数据的存储位置。索引中的项目按索引键值的顺序存储，而表中的信息按照另一种顺序存储。如果在表中未创建聚簇索引，则无法保证这些行具有特定的顺序。
+ 有索引就一定检索的快吗？  
    否。有些时候使用索引还不如不用索引快。举例：我们要检索的表中有8000条记录，如果不用索引，需要访问8000条*1000B/8KB=1000个页面；如果使用索引，首先检索索引，访问8000条*10B/8KB=10个页面，得到索引检索结果，再根据索引检索结果去对应数据页面，由于是检索所有的数据，所以，需要再访问8000条*1000B/8KB=1000个页面，将全部数据读取出来，一共访问了1010个页面。
## InnoDB和MyISAM的区别
+ 在自增长的实现上：MyISAM存储引擎是表锁设计，自增长不用考虑并发插入的问题。
+ 在InnoDB中，自增长值的列必须是索引，同时必须是索引的第一个列，如果不是第一个列，MySQL会抛出异常。而MyISAM存储引擎没有这个问题。
## 范式
## 存储过程和函数
## 数据库事务
## 游标
## 触发器
## sql优化
## SQL语句
## 多线程并发，线程不安全会导致什么问题，怎么解决并发问题？(锁机制)
## 事务并发会导致的问题事务的隔离级别'
## 什么情况下不适合建立索引？
+ 数据库中索引的结构是一种排序的数据结构。
+ 什么情况下不适合建立索引？
    + 对于在查询过程中，很少使用或参考的列，不应该创建索引；
    + 对于那些只有很少数据值的列，不应该创建索引；
    + 对于那些定义为image,text,bit数据类型的列，不应该创建索引；
    + 当修改性能远大于检索性能时，不应该建立索引。
+ 建立索引的优缺点：
    + 优点：
        + 通过创建唯一性的索引，可以保证表中每一行数据的唯一性；
        + 可以大大加快表中数据的检索素的，这也是创建索引的主要原因；
        + 可以加快表与表之间的链接，特别是在实现表与表之间的参考完整性实现有特别的意义；
        + 通过使用索引，可以在查询的过程中，使用优化隐藏器，提高系统性能。
    + 缺点：
        + 创建索引和维护索引耗时，时间随着数据的增加而增加，成正比；
        + 索引需要占物理空间，除了数据表占数据空间外，每一个索引还要占一定的物理空间，如果建立聚簇索引，占得物理空间会更大；
        + 当对表中的数据进行维护时，对索引也要进行维护，这样就降低了数据的维护速度。
+ 可以在数据库中建立三种索引：唯一索引，主键索引，聚集索引。
    + 唯一索引(unique) :不允许任意两行具有相同索引值的索引。
    + 主键索引(primary):数据表中经常有一列或多列组合，其职唯一标识要求主键中的每表中的每一行，则该列称为主键。个值都是唯一的，当查询时使用主键索引，他还允许对数据的快速访问。
    + 聚集索引：表中行的物理顺序和表中的逻辑顺序相同。一个标志能有一个聚集索引。
+ 如果一个索引不是聚集索引，则表中的数据的物理顺序和表中的逻辑顺序不相同。
## sql索引失效
+ 如果条件中有or，即使其中有条件带索引也不会使用(这也是为什么尽量少用or的原因) 注意：要想使用or，又想让索引生效，只能将or条件中的每个列都加上索引
+ 对于多列索引，不是使用的第一部分，则不会使用索引
+ like查询是以%开头（以%结尾是可以的）
+ 如果列类型是字符串，那一定要在条件中将数据使用引号引用起来,否则不使用索引
+ 如果mysql估计使用全表扫描要比使用索引快,则不使用索引